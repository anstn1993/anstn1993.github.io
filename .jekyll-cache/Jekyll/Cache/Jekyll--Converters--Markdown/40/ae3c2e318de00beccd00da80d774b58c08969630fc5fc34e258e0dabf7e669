I"ä&<p>ì´ë²ˆ ê¸€ì—ì„œëŠ” tomcatê³¼ apacheê°€ ì–´ë–»ê²Œ ì—°ê²°ë˜ëŠ”ì§€ì— ëŒ€í•´ì„œ ê°„ë‹¨í•˜ê²Œ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤. ì—¬ê¸°ì„œ apacheëŠ” tomcatì˜ ì•ë‹¨ì— ìœ„ì¹˜í•œ í”„ë¡ì‹œ ì„œë²„ê°€ ë©ë‹ˆë‹¤.</p>

<h2 id="tomcatì˜-connector">Tomcatì˜ Connector</h2>

<hr />

<p>Tomcatì´ ì™¸ë¶€ì˜ ìš”ì²­ì„ ì–´ë–»ê²Œ ë°›ëŠ”ì§€ ë¨¼ì € ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤. Tomcatì€ ë‹¤ì–‘í•œ ì»´í¬ë„ŒíŠ¸ë“¤ë¡œ êµ¬ì„±ì´ ë˜ëŠ”ë°, ê·¸ ì¤‘ Catalinaê°€ ì™¸ë¶€ ìš”ì²­ì„ ë°›ì„ ìˆ˜ ìˆê²Œ ì²˜ë¦¬í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ê°€ Connector ì…ë‹ˆë‹¤. ConnectorëŠ” í•˜ë‚˜ì˜ ì„œë¹„ìŠ¤ ë‚´ì—ì„œ ì—¬ëŸ¬ ê°œë¡œ êµ¬ì„±í•  ìˆ˜ ìˆìœ¼ë©° ê°ê° ìš”ì²­ì„ ë°›ì•„ì„œ ì ì ˆí•œ Context(Web Application)ë¡œ ìš”ì²­ì„ ì „ë‹¬í•´ì£¼ê³  ë™ì ìœ¼ë¡œ ìƒì„±ëœ ì‘ë‹µ ì»¨í…ì¸ ë¥¼ ë°›ì•„ì„œ ì‘ë‹µí•´ì£¼ëŠ” ì—­í• ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.</p>

<p>ê°ê°ì˜ Connectorë“¤ì—ê²Œ ìœ„ì™€ ê°™ì€ ì—­í• ì„ ìˆ˜í–‰í•˜ê²Œ í•˜ê¸° ìœ„í•´ì„œëŠ” ê°€ì¥ ê¸°ë³¸ì ìœ¼ë¡œëŠ” 2ê°€ì§€ë¥¼ ì„¤ì •í•´ì¤˜ì•¼ í•©ë‹ˆë‹¤.</p>

<ol>
  <li>ìš”ì²­ì„ listení•˜ê¸° ìœ„í•œ í¬íŠ¸ ë²ˆí˜¸</li>
  <li>í†µì‹  í”„ë¡œí† ì½œ</li>
</ol>

<p>ìœ„ì™€ ê°™ì€ Connector ì„¤ì •ì€ Tomcatì˜ ì£¼ìš” ì„¤ì • íŒŒì¼ ì¤‘ í•˜ë‚˜ì¸ server.xmlì—ì„œ í•˜ê²Œ ë©ë‹ˆë‹¤.</p>

<ul>
  <li>
    <p>server.xml</p>

    <div class="language-tex highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;Server&gt;
    &lt;Service&gt;
        &lt;Connector port="8000" protocol="HTTP/1.1"/&gt;
        &lt;Connector port="8001" protocol="HTTP/1.1"/&gt;

        &lt;Engine&gt;
            &lt;Host name="yourhostname"&gt;
                &lt;Context path="/webapp1"/&gt;
                &lt;Context path="/webapp2"/&gt;
            &lt;/Host&gt;
        &lt;/Engine&gt;
    &lt;/Service&gt;
&lt;/Server&gt;
</code></pre></div>    </div>

    <p>Server ì—˜ë¦¬ë¨¼íŠ¸ì˜ í•˜ìœ„ ì—˜ë¦¬ë¨¼íŠ¸ë¡œëŠ” Service ì—˜ë¦¬ë¨¼íŠ¸ê°€ ë“¤ì–´ê°€ê³  ì´ ì—˜ë¦¬ë¨¼íŠ¸ì˜ í•˜ìœ„ ì—˜ë¦¬ë¨¼íŠ¸ë¡œ Connectorì—˜ë¦¬ë¨¼íŠ¸ì™€ Engineì—˜ë¦¬ë¨¼íŠ¸ê°€ ë“¤ì–´ê°€ê²Œ ë©ë‹ˆë‹¤. ìœ„ì˜ ì„¤ì •ì„ ì‚´í´ë³´ë©´ Tomcat ì„œë²„ì˜ ConnectorëŠ” ë‘ê°œê°€ ë˜ê³  8000, 8001ë²ˆ í¬íŠ¸ì—ì„œ ìš”ì²­ì„ listení•˜ê²Œ ë©ë‹ˆë‹¤. ì¦‰ ì € ë‘ í¬íŠ¸ë¡œ ìš”ì²­ì„ ë³´ë‚´ë©´ Connectorê°€ ë°›ì•„ì„œ Engineìœ¼ë¡œ ìš”ì²­ì„ ì „ë‹¬í•˜ê²Œ ë©ë‹ˆë‹¤.</p>

    <p>ì•„ë˜ì™€ ê°™ì´ ì„¤ì •í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.</p>

    <div class="language-tex highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;Server&gt;
    &lt;Service name="Catalina8000"&gt;
        &lt;Connector port="8000" protocol="HTTP/1.1"/&gt;
        &lt;Engine&gt;
            &lt;Host name="yourhostname"&gt;
                &lt;Context path="/webapp1"/&gt;
            &lt;/Host&gt;
        &lt;/Engine&gt;
&lt;/Service&gt;
&lt;Service name="Catalina8001"&gt;
        &lt;Connector port="8001" protocol="HTTP/1.1"/&gt;
        &lt;Engine&gt;
            &lt;Host name="yourhostname"&gt;
                &lt;Context path="/webapp2"/&gt;
            &lt;/Host&gt;
        &lt;/Engine&gt;
&lt;/Service&gt;
&lt;/Server&gt;
</code></pre></div>    </div>

    <p>í•œ ì„œë²„ì—ì„œ ë‘ê°œì˜ Serviceë¥¼ êµ¬ì„±í•˜ê³  ê°ê° Connectorë¥¼ êµ¬ì„±í•˜ì—¬ í¬íŠ¸ë³„ë¡œ ìš”ì²­ì´ ì „ë‹¬ë˜ëŠ” Engineì´ ë‹¬ë¼ì§€ê²Œ êµ¬ì„±í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.</p>
  </li>
</ul>

<h2 id="ajp">AJP</h2>

<hr />

<p>ì•ì„œ Connectorì˜ í†µì‹  í”„ë¡œí† ì½œì„ ì„¤ì •í•  ìˆ˜ ìˆë‹¤ê³  ì–¸ê¸‰í–ˆìŠµë‹ˆë‹¤. ëŒ€í‘œì ìœ¼ë¡œ ë‘ ê°€ì§€ íƒ€ì…ì´ ìˆëŠ”ë° í•˜ë‚˜ê°€ ìš°ë¦¬ì—ê²Œ ìµìˆ™í•œ HTTPì´ê³ , ë‹¤ë¥¸ í•˜ë‚˜ê°€ AJPë¼ëŠ” ë…€ì„ì…ë‹ˆë‹¤.</p>

<h4 id="http-connector">HTTP Connector</h4>

<p>Tomcatì€ ê·¸ ìì²´ë§Œìœ¼ë¡œ ë…ë¦½ì  ì›¹ ì„œë²„ë¡œ ì‘ë™í•©ë‹ˆë‹¤. ê·¸ê²Œ ê°€ëŠ¥í•œ ì´ìœ ê°€ ë°”ë¡œ HTTP Connectorë¼ëŠ” ì»´í¬ë„ŒíŠ¸ê°€ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. HTTP ConnectorëŠ” HTTP/1.1 ë²„ì „ì„ ì§€ì›í•˜ë©´ì„œ ì›¹ìƒì˜ HTTP ìš”ì²­ì„ ëª¨ë‘ ë°›ì•„ì¤ë‹ˆë‹¤.</p>

<h4 id="ajp-connector">AJP Connector</h4>

<p>AJPëŠ” Apache JServ Protocolì˜ ì•½ìë¡œ Apache ì›¹ ì„œë²„ì™€ í†µì‹ ì„ í•˜ê¸° ìœ„í•´ì„œ ê³ ì•ˆëœ HTTP ë°”ì´ë„ˆë¦¬ í”„ë¡œí† ì½œ ì…ë‹ˆë‹¤. ì¦‰ AJP ConnectorëŠ” ì•„íŒŒì¹˜ë¥¼ í†µí•´ì„œ ì „ë‹¬ë˜ëŠ” ìš”ì²­ì„ ë°›ì•„ì„œ ì²˜ë¦¬í•˜ëŠ” ì—­í• ì„ ë‹´ë‹¹í•˜ëŠ” íŠ¹í™”ëœ Connectorë¼ê³  ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¹ì—°íˆ Apacheì™€ì˜ ì—°ë™ì´ê¸° ë•Œë¬¸ì— ì–‘ìª½ ëª¨ë‘ì— ë³„ë„ì˜ ì„¤ì •ì„ í•´ì¤˜ì•¼ í•©ë‹ˆë‹¤.</p>

<h2 id="ajp-configuration">AJP Configuration</h2>

<hr />

<p>Apacheì™€ Tomcatì˜ ì—°ë™ì„ ìœ„í•œ ì„¤ì •ì„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.</p>

<h4 id="tomcat-configuration">Tomcat Configuration</h4>

<p>ë¨¼ì € ìƒëŒ€ì ìœ¼ë¡œ ê°„ë‹¨í•œ Tomcatë¶€í„° ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.</p>

<ul>
  <li>server.xml
    <div class="language-tex highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;Server&gt;
    &lt;Service name="Catalina"&gt;
        &lt;Connector port="8001" protocol="AJP/1.3"/&gt;
        &lt;Engine name="Catalina"&gt;
            &lt;Host name="localhost"/&gt;
                &lt;Context path="/"/&gt;
            &lt;/Host&gt;
        &lt;/Engine&gt;
    &lt;/Service&gt;
&lt;/Server&gt;
</code></pre></div>    </div>
    <p>Connectorì˜ í”„ë¡œí† ì½œì„ AJPë¡œ ì„¤ì •í•´ì¤¬ê³  í¬íŠ¸ëŠ” 8001ë²ˆìœ¼ë¡œ ì„¤ì •í–ˆìŠµë‹ˆë‹¤. ê°„ë‹¨í•˜ì£ ?</p>
  </li>
</ul>

<h4 id="apache-configuration">Apache Configuration</h4>

<p>Apacheì—ì„œ í•„ìš”í•œ ì„¤ì •ì„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.</p>

<h5 id="1-mod_jk-ë‹¤ìš´ë¡œë“œ">1. mod_jk ë‹¤ìš´ë¡œë“œ</h5>

<p>mod_jkëŠ” Apacheì˜ HTTPDê°€ Tomcatê³¼ AJP í”„ë¡œí† ì½œë¡œ í†µì‹ ì„ í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” Apache ëª¨ë“ˆì…ë‹ˆë‹¤. ì´ ëª¨ë“ˆì„ ë‹¤ìš´ë¡œë“œí•©ë‹ˆë‹¤. (<a href="http://tomcat.apache.org/download-connectors.cgi">mod_jk ë‹¤ìš´ë¡œë“œ ë§í¬</a>)</p>

<h5 id="2-mod_jk-ì„¤ì¹˜">2. mod_jk ì„¤ì¹˜</h5>

<p>ë‹¤ìš´ë¡œë“œëœ íŒ¨í‚¤ì§€ì— ìˆëŠ” mod_jkëª¨ë“ˆì„ ì°¾ì•„ì„œ ê·¸ íŒŒì¼ì„ Apacheì˜ modulesë””ë ‰í† ë¦¬ë¡œ ì˜®ê²¨ì¤ë‹ˆë‹¤.(ë¦¬ëˆ…ìŠ¤ì˜ ê²½ìš° mod_jk.so, ìœˆë„ìš°ì˜ ê²½ìš° mod_jk.dll)</p>

<h5 id="3-httpdconf-ì„¤ì •">3. httpd.conf ì„¤ì •</h5>

<p>ëª¨ë“ˆì„ ì˜®ê²¨ì¤¬ìœ¼ë©´ ì„¤ì • íŒŒì¼ì—ì„œ ê·¸ ëª¨ë“ˆì„ ì‚¬ìš©í•˜ê² ë‹¤ê³  ì„ ì–¸ì„ í•´ì•¼ í•©ë‹ˆë‹¤. ì•„ë˜ì— ë‚˜ì˜¤ëŠ” ì„¤ì •ì€ mod_jk ëª¨ë“ˆì´ ì •ìƒì ìœ¼ë¡œ ë™ì‘í•˜ëŠ” ë° í•„ìš”í•œ ì„¤ì •ë“¤ì…ë‹ˆë‹¤.(ê°ì¢… íŒŒì¼ë“¤ì˜ ê²½ë¡œëŠ” ì˜ˆì‹œë¡œ ì‘ì„±ëœ ê²ƒì´ê¸° ë•Œë¬¸ì— ì‹¤ì œ ìì‹ ì˜ íŒŒì¼ì˜ ê²½ë¡œë¥¼ ë„£ì–´ì£¼ë©´ ë©ë‹ˆë‹¤.)</p>

<ul>
  <li>
    <p>httpd.conf</p>

    <div class="language-tex highlighter-rouge"><div class="highlight"><pre class="highlight"><code># Load the mod<span class="p">_</span>jk module.
LoadModule    jk<span class="p">_</span>module  path/to/mod<span class="p">_</span>jk.so

# Declare the module for use with the &lt;IfModule directive&gt; element.  (This only applies to versions of HTTPD below 2.x.  For 2.x and above, REMOVE THIS LINE.)
AddModule     mod<span class="p">_</span>jk.c

# Set path to workers.properties. We will create this file in the next step.  The file will be placed in the same directory as httpd.conf.
JkWorkersFile /path/to/httpd/conf/workers.properties

# Set path to jk shared memory.  Generally, you'll want this to point to your local state or logs directory.
JkShmFile     /path/to/log/httpd/mod<span class="p">_</span>jk.shm

# Set path to jk logs.  This path should point to the same logs directory as the HTTPD access<span class="p">_</span>log.
JkLogFile     /path/to/log/httpd/mod<span class="p">_</span>jk.log

# Set the jk log level.  Valid values for this setting are 'debug', 'error', or 'info'.
JkLogLevel    level

# Set timestamp log format.  Use provided variables to customize.
JkLogStampFormat "[<span class="c">%a %b %d %H:%M:%S %Y] "</span>

# Map a worker to a namespace.  Workers represent Tomcat instances that are listening for requests.  We'll configure these in the next section.  For the sake of this example, Tomcat's "examples" context is used, and a default worker named 'worker1', which we will create in Step 4, is designated.  Multiple JkMount attributes can be used simultaneously.
JkMount  /examples/* worker1
</code></pre></div>    </div>

    <p>ìœ„ì˜ ì„¤ì •ì—ì„œ JkMountë¥¼ ë³´ë©´ workerì— ëŒ€í•œ mapping ì„¤ì •ì´ ì¡´ì¬í•©ë‹ˆë‹¤. WorkerëŠ” Tomcat ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤. ìœ„ì˜ ì„¤ì •ì„ í•´ì„í•´ë³´ìë©´ /examples/ ì´í•˜ë¡œ ë“¤ì–´ì˜¤ëŠ” ìš”ì²­ì€ ëª¨ë‘ worker1ë¡œ ë¼ìš°íŒ…ì„ í•´ì£¼ë¼ëŠ” ì˜ë¯¸ê°€ ë©ë‹ˆë‹¤. ì¦‰ ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´ ajpë¡œ Tomcatì—ê²Œ ìš”ì²­ì„ ì „ë‹¬í•˜ë¼ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤.</p>
  </li>
</ul>

<h5 id="4-worker-ì„¤ì •">4. Worker ì„¤ì •</h5>

<p>3ë²ˆì—ì„œ JkMountì„¤ì •ìœ¼ë¡œ worker1ì„ ì§€ì •í•´ì¤¬ì§€ë§Œ ê·¸ Workerì— ëŒ€í•œ ì •ë³´ê°€ ì•„ì§ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. Workerì— ëŒ€í•œ ì •ë³´ëŠ” workers.propertiesì—ì„œ ì„¤ì •í•´ì£¼ê²Œ ë©ë‹ˆë‹¤.</p>

<ul>
  <li>workers.properties
    <div class="language-tex highlighter-rouge"><div class="highlight"><pre class="highlight"><code>worker.list=worker1
worker.worker1.type=ajp13
worker.worker1.host=localhost
worker.worker1.port=8001
</code></pre></div>    </div>
    <ul>
      <li>worker.list: Workerì˜ namespaceë¥¼ ì§€ì •í•©ë‹ˆë‹¤. ë³µìˆ˜ì˜ Workerë¥¼ ì§€ì •í•˜ê³  ì‹¶ë‹¤ë©´ â€˜,â€™ë¥¼ ì“°ê³  ì´ì–´ë‚˜ê°€ë©´ ë©ë‹ˆë‹¤.</li>
      <li>worker.worker1.type: worker1ê³¼ì˜ í†µì‹  í”„ë¡œí† ì½œì„ ì§€ì •í•©ë‹ˆë‹¤.</li>
      <li>worker.worker1.host: worker1ì˜ ì£¼ì†Œë¥¼ ì§€ì •í•©ë‹ˆë‹¤.</li>
      <li>worker.worker1.port: worker1ì˜ í¬íŠ¸ë²ˆí˜¸ë¥¼ ì§€ì •í•©ë‹ˆë‹¤. ì•ì„  Tomcatì„¤ì •ì—ì„œ AJP Connectorì˜ í¬íŠ¸ ë²ˆí˜¸ë¥¼ 8001ë¡œ ì„¤ì •í–ˆìŠµë‹ˆë‹¤.</li>
    </ul>
  </li>
</ul>

<p>ì—¬ê¸°ê¹Œì§€ê°€ Apacheì™€ Tomcatì´ AJPë¥¼ í†µí•´ì„œ í†µì‹ í•˜ê¸° ìœ„í•œ ê¸°ë³¸ì ì¸ ì„¤ì • ì…ë‹ˆë‹¤.</p>

<h2 id="ë§ˆì¹˜ë©°">ë§ˆì¹˜ë©°</h2>

<hr />

<p>ê¸°ìˆ êµìœ¡ í”„ë¡œì íŠ¸ì˜ ì›¹ ì„œë²„ êµ¬ì„±ì´ Apache + Tomcatì´ì—ˆëŠ”ë° ì •í™•íˆ ì–´ë–»ê²Œ ì—°ë™ì´ ë˜ëŠ”ì§€ ì˜ ëª¨ë¥´ê³  ì‚¬ìš©ì„ í•´ì™€ì„œ ê³µë¶€ ì°¨ì›ì—ì„œ ì´ ê¸€ì„ ì‘ì„±í•©ë‹ˆë‹¤. ìœ„ì˜ ì„¤ì •ë“¤ì€ ì •ë§ ê¸°ë³¸ì ì¸ ì„¤ì •ë“¤ì´ê³  ê·¸ ì™¸ì—ë„ ì‚¬ìš©ìì˜ ë‹ˆì¦ˆì— ë”°ë¥¸ ë‹¤ì–‘í•œ ì„¤ì •ë“¤ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì´ëŸ° ì„¤ì •ë“¤ë„ ì•ìœ¼ë¡œ ê°œë°œì„ í•´ë‚˜ê°€ë©´ì„œ í•˜ë‚˜í•˜ë‚˜ ìµí˜€ì•¼ê² ë‹¤ëŠ” ìƒê°ì´ ë“­ë‹ˆë‹¤.</p>
:ET