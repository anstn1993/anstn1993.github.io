---
layout: post
title: test                               # Title of the page
hide_title: true                                  # Hide the title when displaying the post, but shown in lists of poststhumbnail: "assets/img/thumbnails/sample-th.png"  # Add 
color: rgb(80,140,22)                             # Add the specified color as feature image, and change link colors in post
bootstrap: true                                   # Add bootstrap to the page
tags: [test]
---

# 10. Collections

앞에서 게시물에 대한 페이지를 만들었다면 이번에는 블로그를 여러 저자들이 운영한다고 가정하고 그 저자들별로 개인 페이지가 생기게 만들어본다.

그것을 위해서 Collections를 쓰는데 Posts와 전반적으로 비슷하나 날짜를 기준으로 그룹화가 되지 않는다는 차이가 있다. 

### _config.yml

* jekyll의 설정파일이다.

* 이 파일에 collectoins에 대한 설정을 해준다.

* 루트에 _config.yml을 생성하고 다음을 추가한다.

  ```yaml
  collections:
  	authors:
  ```

  설정파일의 수정사항 반영을 위해서는 서버를 종료하고 다시 시작한다. 

### authors 추가

* collections의 item은 우리가 앞에서 본 posts, includes같이 루트에 위치한 디렉토리에 있는 파일들을 의미한다.

* 이 경우 _authors디렉토리를 추가하면 author에 대한 collections가 생성된다고 보면 된다.

* _authors디렉토리에 author를 추가한다.

  _authors/jill.md파일

  ```html
  ---
  short_name: jill
  name: Jill Smith
  position: Chief Editor
  ---
  Jill is an avid fruit grower based in the south of France.
  ```

  _authors/ted.md파일

  ```html
  ---
  short_name: ted
  name: Ted Doe
  position: Writer
  ---
  Ted has been eating fruit since he was baby.
  ```

### Staff 페이지 추가

* author들에 대한 정보를 리스팅할 staff 페이지를 루트에 생성한다.

  staff.html파일

  ```html
  ---
  layout: default
  title: Staff
  ---
  <h1>Staff</h1>
  
  <ul>
    {% for author in site.authors %}
      <li>
        <h2>{{ author.name }}</h2>
        <h3>{{ author.position }}</h3>
        <p>{{ author.content | markdownify }}</p>
      </li>
    {% endfor %}
  </ul>
  ```

  _authors디렉토리의 author파일의 정보는 site.authors로 접근 가능하다. 그리고 author파일의 확장자가 마크다운이기 때문에 content를 마크다운 필터로 실행해야 한다. 이 처리는 default layout의 {{ content }}부분이 렌더링될 때 자동으로 처리된다.

* 이 페이지를 네비게이션에 추가한다.

  _data/navigation.yml파일

  ```yaml
  - name: Home
    link: /
  
  - name: About
    link: /about.html
  
  - name: Blog
    link: /blog.html
  #추가된 부분
  - name: Staff
    link: /staff.html
  ```

### Staff페이지 출력

* 기본적으로 Collections는 각 문서들을 위한 정보를 페이지에서 출력하지 않아서 정보에 접근할 수 없다. 우리는 각 저자가 자신의 페이지를 가지게 하는 것이 목적이기 때문에 _config.yml에서 활성화해준다. 

  ```yaml
  collections:
    authors:
      output: true
  ```

* 이제 staff페이지에서 author.url을 통해서 각 저자 페이지에 대한 링크를 구할 수 있다. 

  ```html
  ---
  layout: default
  title: Staff
  ---
  <h1>Staff</h1>
  
  <ul>
    {% for author in site.authors %}
      <li>
        <h2>
        	<!--추가된 태그-->  
          <a href="{{ author.url }}">{{ author.name }}</a>
        </h2>
        <h3>{{ author.position }}</h3>
        <p>{{ author.content | markdownify }}</p>
      </li>
    {% endfor %}
  </ul>
  ```

* 그럼 author 전용 layout도 생성해준다.

  _layouts/author.html파일

  ```html
  ---
  layout: default
  ---
  <h1>{{ page.name }}</h1>
  <h2>{{ page.position }}</h2>
  
  {{ content }}
  
  ```

### 머리말 기본값

그런데 뭔가 빠진 것 같은 느낌이 든다. author layout을 만들었으면 author파일에서 레이아웃 지정을 해줘야 하는데 우린 그런 걸 한 적이 없다. 그 설정도 이젠 _config.yml에서 해줄 것이다. 반복을 최소화할 수 있는 것이다. 아래와 같이 설정하면 매번 파일을 만들 때마다 레이아웃 지정을 안 해줘도 이 설정대로 적용이 된다. 

_config.yml파일

```yaml
collections:
  authors:
    output: true

defaults:
  - scope:
      path: ""
      type: "authors"
    values:
      layout: "author"
  - scope:
      path: ""
      type: "posts"
    values:
      layout: "post"
  - scope:
      path: ""
    values:
      layout: "default"
```

type에 컬렉션이 들어가고 그 컬렉션의 파일의 머리말에 default로 추가해줄 값을 values아래에 쭉 적어주는 것이다. 

### author 페이지에서 저자의 게시물만 리스팅하기

저자의 페이지에서 저자가 작성한 게시물을 리스팅해본다. 

* author파일의 short_name값과 post파일의 author값이 일치해야 작성자별 게시물 필터링이 된다. 

* author.html파일에 게시물이 출력되어야 하니까 해당 파일에 필터링된 게시물을 출력해준다.

  _layouts/author.html파일

  ```html
  ---
  layout: default
  ---
  <h1>{{ page.name }}</h1>
  <h2>{{ page.position }}</h2>
  
  {{ content }}
  
  <h2>Posts</h2>
  <ul>
    {% assign filtered_posts = site.posts | where: 'author', page.short_name %}
    {% for post in filtered_posts %}
      <li><a href="{{ post.url }}">{{ post.title }}</a></li>
    {% endfor %}
  </ul>
  ```

  * assgin구문: filetered_posts는 site.posts중에 where조건에 해당하는 게시물만 담는다. 

### post 페이지에서 author 링크 출력하기

게시물 페이지에서 저자의 정보가 출력되게 해야 한다. 

* _layouts/post.html파일에 assign구문을 적용한다.

  _layouts/post.html 파일

  ```html
  ---
  layout: default
  ---
  <h1>{{ page.title }}</h1>
  
  <p>
    {{ page.date | date_to_string }}
    {% assign author = site.authors | where: 'short_name', page.author | first %}
    {% if author %}
      - <a href="{{ author.url }}">{{ author.name }}</a>
    {% endif %}
  </p>
  
  {{ content }}
  ```

  